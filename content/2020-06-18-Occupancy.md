date: 2020-06-18
title: Estimating site occupancy rates when detection probabilities are less than on
tags: Occupancy models
Category: Review


**Обзор основных методов статьи
[MacKenzie, D.I., Nichols, J.D., Lachman, G.B., Droege, S., Royle, J.A. &
Langtimm, C.A. (2002) Estimating site occupancy rates when detection probabilities are less than one. Ecology, 83, 2248–2255.](https://projects.ncsu.edu/cals/course/zo501/2016%20Sampling%20Lab/MacKenzie%202002.pdf)
**

## Вводная часть

Ранее уже рассматривалось несколько работ, посвященных оценке ореала животных по следам присустствия. 
Значительная часть исследований
в данной тематике ссылается на статью MacKenzie с соавторами, следует предложенной в ней методике или расширяет ее.

Указанная работа описывает подход для оценки пропорции местообитаний, занятых исследуемым животным,
при этом важно отметить, что изначально авторы занимались земноводными и обследовали озера/болота,
поэтому описанная ими методика -- дискретная, точнее, сбор данных происходит в дискретном пространстве:
пространство естественным образом разбито на ограниченные участки (озера), для которых возможно только два
варианта событий -- в озере либо найдены следы присутствия вида, либо не найдены.

При сборе данных о присутсвии вида нужно учитывать возможность того, что даже если вид присутствует
на территории, то следы его присуствия могут быть пропущены при сборе данных по тем или иным причинам,
другими словами вероятность детекции вида представляет собой величину, меньшую единицы, даже при условии того,
что вид присутсвует.

MacKenzie и соавторы исходят из посылки, что если вероятность обнаружения следов меньше единицы,
то неоднократным повторением обследования одного и того же места (но в разные периоды времени) можно
получить оценку вероятности обнаружения следов. А зная данную оценку, можно выйти на оценку доли занятых
видом мест среди всех обследованных потенциальных местообитаний.
Статья MacKenzie et al. описывает математические основы процедуры оценки данной вероятности и условия их применимости.


## Обозначения
Пусть $\psi_i$ -- вероятность того, что вид присутствует в месте номер $i$, $p_{it}$ -- вероятность того, что
следы присутствия вида были обнаружены в месте номер $i$ в ходе обследования номер $t$ (при условии, что вид
присутсвовал в данном месте). Пусть $N$ -- число обследованных мест, а $T$ -- число проведенных циклов исследований,
$n_t$ -- число мест, в которых были найдены следы присутствия вида в ходе обследования номер $t$, $n_{o}$ -- общее количество
мест, в которых следы присутствия были найдены хотя бы один раз.


## Процедура сбора данных и предположения, лежащие в ее основе
Проводится обследование $N$ мест (участков), в ходе $T$ отдельных посещений. Предполагается, что:

(1) ситуация на участках стабильна, т.е. обследуемые участки заняты (или не заняты) видом в течении всего периода исследований:

   - ни одного пустого участка (из исследуемых) за время обследования не было заселено видом;
   - ни с одного занятого участка (из исследуемых) не было покинуто видом за время обследования.

(2) если вид отсутствует на участке, то следы присутствия не будут обнаружены ни при каких условиях (например,
   не может быть ложных отнесений следов иного вида к исследуемому виду).

(3) присутствие следов в одном месте не зависит от присустствия (остуствия) следов в других местах.

В итоге данные обследования по каждому участку сводятся в последовательность нулей и единиц, где 1 означает, что
вид был обнаружен, а 0 -- не обнаружен. Каждому обседованному участку в конце периода исследований
прописывается такая последовательность обнаружений/не-обнаружений.

## Основная модель

Модель очень проста и легче всего ее пояснить на примере. Предположим, что в было всего 5 этапов обследований участков. Предположим,
что на некотором учаске номер $i$ была зафиксирована следующая история наблюдений: 01010. Тогда вероятность получить данную историю
наблюдений равняется:

$$
\psi_i (1-p_{i1})p_{i2}(1-p_{i3})p_{i4}(1-p_{i5})
$$

В случае, когда на участке не было ни одного обнаружения следов вида за всю историю наблюдений (в нашем пример -- пять нулей, 00000),
возможны варианты: (а) животных там и в самом деле нет (б) животных попросту не удалось обнаружить. Поэтому если на участке $k$ не было
ни одного обнаружения, то вероятность получить такую историю наблюдений равняется:

$$
\psi_k \prod_{t=1}^5 (1 - p_{kt}) + (1-\psi_k).
$$

Подобным же образом строятся вероятности получить наблюдаемые истории присутствия следов в общем случае. Однако, полученная модель
будет иметь слишком много параметров, чтобы ее можно было оценить по имеющимся наблюдениям, поэтому модель необходимо упростить.
Наиболее простой вариант -- предположить, что вероятность присутствия вида и обнаружения следов являются константами. В этом
случае  можно построить функцию правдоподобия по результатам всех наблюдений на всех участках:

$$
L(\psi, \mathbf{p}) = \big[\psi^{n_{o}}\prod_{t=1}^T p^{n_t}_t (1-p_t)^{n_{o} - n_t} \big] \times \big[\psi \prod_{t=1}^T (1-p_t)+ (1-\psi) \big].
$$

Таким образом задача сводится к тому, чтобы подобрать такие параметры $\psi$, $p_1, p_2, \dots, p_n$, которые обеспечивают достижения
максимума функции $L$.


### Развитие модели
#### Факторы

Логично предположить, что вероятность присутсвия вида на некотором участке зависит от неких геоэкологических факторов. Аналогично,
вероятность обнаружения также может меняться в зависимости от определенных параметров, например, погодных. Такие факторы
могут быть встроены в модель, например, можно ее расширить при помощи логистической функции -- потребовать, чтобы величина $\psi$
удовлетворяла следующей зависимости от объясняющих факторов $\mathbf{X}$ и параметров модели $\mathbf{B}$:

$$
\psi_i = \frac{e^\mathbf{XB}}{1 + e^\mathbf{XB}}.
$$
Аналогично моделируется величина $p$.

#### Отсутсвующие наблюдения
Не всегда возможно получить одинаковое количество наблюдений за участками. Например, для какого-либо учатка возможна такая история наблюдений:
10-11, когда было пропущено третье по счету исследование. В этом случае функция правдоподобия для данного участка будет выглядеть
следующим образом:

$$
\psi p_1 (1-p_2) p_4 p_5.
$$

В таком случае, чтобы учесть отсутствующие наблюдения, придется вычислять параметры для каждого участка по отдельности,
а не в общем виде.


