date: 2019-12-09
title:  Tigers on trails: occupancy modeling for cluster sampling
tags: Occupancy models
Category: Review


**Обзор основных методов статьи
[Tigers on trails: occupancy modeling for cluster sampling](https://esajournals.onlinelibrary.wiley.com/doi/abs/10.1890/09-0321.1)**


## Суть задачи
Нужно создать методику оценки ареала вида по собранным следам присутствия. При этом ожидается, что данные по следам
присутсвия животных:

 * локально зависимы (более точно -- подчиняются Марковскому закону);
 * собраны не случайным образом, а следуют из необходимости соблюдать компромис между статистическим и практическими требваниями (обычно логистического плана).

Предлагаемая методика использовалась для оценки ареала тигров в штате Карнатака (Индия).

## Сбор данных

### Как делили территорию и собирали данные
Исследуемая территория занимает 22 тыс. кв. км. и расположена в штате Карнатака на юго-западе Индии. Поскольку известно, что тигры используют лесные дороги и помечают свою территорию, оставляя различные следы на дорогах, то поиск таких следов вдоль дорог занчительно повышает вероятность детекции тигра по сравнению со случайным поиском (построением случайных ячеек и их обследованием).

Таким образом территория разбивалась на ячейки в 200 кв. километров (средний размер "домашней" территории тигра), внутри анализируемых ячеек случайным образом выбиралась точка, через которую прокладывался маршрут (с проходом по дорогам). Затем по маршруту проходили исследователи и искали следы присутсвия тигров. Каждый маршрут разбивался на участки длиной в один километр. 

На каждом сегменте отмечалось присутствие или отсуствие следов животных в виде бинарной величины.


## Вычисления
Поскольку методика подразумевает анализ ареалов очень подвижных животных, которые могут передвигаться по дорогам иногда до нескольких километров, то вероятность встретить следы животного на следующем сегменте маршрута повышается, если следы были замечены на текущем сегменте. Таким образом в основе модели лежит идея использовать Марковские процессы и схему выборки с возвращением. Более конкретно:

 * выбирается ячейка для анализа;
 * начинается маршрут, состоящий из $K$ последовательных сегментов;
 * записывается история встреч следов животного на маршруте (бинарная величина, есть следы или нет);
 * по завершению маршрута получается бинарный вектор из $K$ нулей и единиц, например, для ячейки $j$, состоящей из пяти сегментов, может быть получена следующая история: $h_j = 01011$, означающая, что следы не были обнаружены на 1-м и 3-м сегменте маршрута.

Как обычно, в модели учитываются вероятности того, что животное (его следы) может быть не обнаружено, хотя по факту оно присутствует.

Вводятся обозначения:

 * $p$ - вероятность детекции следов на сегменте, при условии, что животное (следы) находилось в ячейке;
 * $\psi$ - вероятность того, что животное (следы) находилось в ячейке;
 * $\theta$ - вероятность того, что животное (следы) находилось на сегменте при условии, что ячейка занята животным и животное не посещало предыдущий сегмент;
 * $\theta'$ - вероятность того, что животное находилось на сегменте при условии, что ячейка была занята животным и следы животного были найдены на предыдущем сегменте.

Эта схема позволяет задать Марковский процесс с ненаблюдаемой случайной переменной, означающей, было ли животное на предыдущем сегменте. Например, для следующей истории наблюдений $h_j = 01011$ данный процесс выражается следущей формулой:

$$
Pr(h_j = 01011) = \underbrace{\psi}_{\text{тигр в ячейке}}
       \underbrace{\Big[ \underbrace{(1-\theta)}_\text{тигра нет на сегм.}\theta + \underbrace{\theta(1-p)}_\text{тигр пропущен}\theta'\Big ]}_\text{I сегм.}
       \underbrace{\underbrace{p}_\text{следы найдены}}_\text{II сегм.}
       \underbrace{[(1-\theta ')\theta + \theta' (1-p)\theta']}_\text{III сегм.}
       \underbrace{p}_\text{IV сегм.}
       \underbrace{\theta' p}_\text{V сегм.}
$$

В этой формуле учитывается то, что если следов животных на сегменте не было обнаружено, то это может быть потому, что животного действительно там нет. Поэтому, рассматривая тот факт, что следы животного найдены на втором сегменте, мы не знаем, с какой именно вероятностью имеем дело ($\theta$ или $\theta'$), следовательно вероятность не обнаружить следы в первом сегменте получаются в виде суммы произведения вероятностей.

В случае, когда в ячейке не было обнаружено следов присуствия, также рассматривается две возможности -- отсуствие животного и его пропуск. Например, для маршрута состоящего из двух сегментов:

$$
Pr(h_j = 00) = (1-\psi) + \psi\Big [\theta (1-p)(1-\theta' p) + (1-\theta)(1-\theta p) \Big].
$$


Таким образом вся история наблюдений описывается функцией правдоподобия:
$$
L(\psi, \theta, \theta', p | h_1,h_2,\dots, h_s) = \prod_{j=1}^s Pr(h_j).
$$


*Замечание 1.* Таким образом в модели подразумевается, что для всех ячеек и всех сегментов все вероятности равны между собой, т.е. $p$, $\theta$ и $\theta'$ не зависят от местоположения.


Реализация моделей производилась в программе PRESENCE [1].

## Дальнейшие действия
Поскольку моя цель -- ознакомление с общими принципами, лежащими в основе моделей, то на этом этапе я останавливаюсь. Тем не менее следует сказать, что статья не заканчивается выводом модели. Далее авторы производят исследование методики на искусственно сгенерированных данных, изучают ошибки различных моделей. После исследования моделей авторы применяют модель к реальным данным -- поиску тигров.



# Литература

[1] Hines, J. E. 2006. PRESENCE2: software to estimate patch
occupancy and related parameters. U.S. Geological Survey,
Patuxent Wildlife Research Center, Laurel, Maryland, USA.
hhttp://www.mbr-pwrc.usgs.gov/software/presence.html



# Комментарии

Статья написана очень хорошо, дает достаточно полную картину, приводит логику вывода модели и сопровождает ее деталями. Видно, что авторы очень хорошо понимают, что делают и почему так, а не иначе. Очень рекомендую ее для введения в тематику.
