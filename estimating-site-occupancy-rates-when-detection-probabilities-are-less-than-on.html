<!DOCTYPE html>
<html lang="ru">
<head>
        <meta charset="utf-8" />
        <title>Estimating site occupancy rates when detection probabilities are less than on</title>
        <link rel="stylesheet" href="https://kolesovdmitry.github.io/logbook/theme/css/main.css" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://kolesovdmitry.github.io/logbook/">Список всего </a></h1>
                <nav><ul>
                    <li><a href="https://kolesovdmitry.github.io/logbook/category/change-detection.html">Change Detection</a></li>
                    <li><a href="https://kolesovdmitry.github.io/logbook/category/gee.html">GEE</a></li>
                    <li><a href="https://kolesovdmitry.github.io/logbook/category/neuralnets.html">NeuralNets</a></li>
                    <li><a href="https://kolesovdmitry.github.io/logbook/category/raster-processing.html">Raster Processing</a></li>
                    <li class="active"><a href="https://kolesovdmitry.github.io/logbook/category/review.html">Review</a></li>
                    <li><a href="https://kolesovdmitry.github.io/logbook/category/stats.html">Stats</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://kolesovdmitry.github.io/logbook/estimating-site-occupancy-rates-when-detection-probabilities-are-less-than-on.html" rel="bookmark"
           title="Permalink to Estimating site occupancy rates when detection probabilities are less than on">Estimating site occupancy rates when detection probabilities are less than on</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2020-06-18T00:00:00+03:00">
                Published: Чт 18 июня 2020
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://kolesovdmitry.github.io/logbook/author/dmitry-kolesov.html">Dmitry Kolesov</a>
        </address>
<p>In <a href="https://kolesovdmitry.github.io/logbook/category/review.html">Review</a>.</p>
<p>tags: <a href="https://kolesovdmitry.github.io/logbook/tag/occupancy-models.html">Occupancy models</a> </p>
</footer><!-- /.post-info -->      <p><strong>Обзор основных методов статьи
<a href="https://projects.ncsu.edu/cals/course/zo501/2016%20Sampling%20Lab/MacKenzie%202002.pdf">MacKenzie, D.I., Nichols, J.D., Lachman, G.B., Droege, S., Royle, J.A. &amp;
Langtimm, C.A. (2002) Estimating site occupancy rates when detection probabilities are less than one. Ecology, 83, 2248–2255.</a>
</strong></p>
<h2>Вводная часть</h2>
<p>Ранее уже рассматривалось несколько работ, посвященных оценке ореала животных по следам присустствия. 
Значительная часть исследований
в данной тематике ссылается на статью MacKenzie с соавторами, следует предложенной в ней методике или расширяет ее.</p>
<p>Указанная работа описывает подход для оценки пропорции местообитаний, занятых исследуемым животным,
при этом важно отметить, что изначально авторы занимались земноводными и обследовали озера/болота,
поэтому описанная ими методика -- дискретная, точнее, сбор данных происходит в дискретном пространстве:
пространство естественным образом разбито на ограниченные участки (озера), для которых возможно только два
варианта событий -- в озере либо найдены следы присутствия вида, либо не найдены.</p>
<p>При сборе данных о присутсвии вида нужно учитывать возможность того, что даже если вид присутствует
на территории, то следы его присуствия могут быть пропущены при сборе данных по тем или иным причинам,
другими словами вероятность детекции вида представляет собой величину, меньшую единицы, даже при условии того,
что вид присутсвует.</p>
<p>MacKenzie и соавторы исходят из посылки, что если вероятность обнаружения следов меньше единицы,
то неоднократным повторением обследования одного и того же места (но в разные периоды времени) можно
получить оценку вероятности обнаружения следов. А зная данную оценку, можно выйти на оценку доли занятых
видом мест среди всех обследованных потенциальных местообитаний.
Статья MacKenzie et al. описывает математические основы процедуры оценки данной вероятности и условия их применимости.</p>
<h2>Обозначения</h2>
<p>Пусть <span class="math">\(\psi_i\)</span> -- вероятность того, что вид присутствует в месте номер <span class="math">\(i\)</span>, <span class="math">\(p_{it}\)</span> -- вероятность того, что
следы присутствия вида были обнаружены в месте номер <span class="math">\(i\)</span> в ходе обследования номер <span class="math">\(t\)</span> (при условии, что вид
присутсвовал в данном месте). Пусть <span class="math">\(N\)</span> -- число обследованных мест, а <span class="math">\(T\)</span> -- число проведенных циклов исследований,
<span class="math">\(n_t\)</span> -- число мест, в которых были найдены следы присутствия вида в ходе обследования номер <span class="math">\(t\)</span>, <span class="math">\(n_{o}\)</span> -- общее количество
мест, в которых следы присутствия были найдены хотя бы один раз.</p>
<h2>Процедура сбора данных и предположения, лежащие в ее основе</h2>
<p>Проводится обследование <span class="math">\(N\)</span> мест (участков), в ходе <span class="math">\(T\)</span> отдельных посещений. Предполагается, что:</p>
<p>(1) ситуация на участках стабильна, т.е. обследуемые участки заняты (или не заняты) видом в течении всего периода исследований:</p>
<ul>
<li>ни одного пустого участка (из исследуемых) за время обследования не было заселено видом;</li>
<li>ни с одного занятого участка (из исследуемых) не было покинуто видом за время обследования.</li>
</ul>
<p>(2) если вид отсутствует на участке, то следы присутствия не будут обнаружены ни при каких условиях (например,
   не может быть ложных отнесений следов иного вида к исследуемому виду).</p>
<p>(3) присутствие следов в одном месте не зависит от присустствия (остуствия) следов в других местах.</p>
<p>В итоге данные обследования по каждому участку сводятся в последовательность нулей и единиц, где 1 означает, что
вид был обнаружен, а 0 -- не обнаружен. Каждому обседованному участку в конце периода исследований
прописывается такая последовательность обнаружений/не-обнаружений.</p>
<h2>Основная модель</h2>
<p>Модель очень проста и легче всего ее пояснить на примере. Предположим, что в было всего 5 этапов обследований участков. Предположим,
что на некотором учаске номер <span class="math">\(i\)</span> была зафиксирована следующая история наблюдений: 01010. Тогда вероятность получить данную историю
наблюдений равняется:</p>
<div class="math">$$
\psi_i (1-p_{i1})p_{i2}(1-p_{i3})p_{i4}(1-p_{i5})
$$</div>
<p>В случае, когда на участке не было ни одного обнаружения следов вида за всю историю наблюдений (в нашем пример -- пять нулей, 00000),
возможны варианты: (а) животных там и в самом деле нет (б) животных попросту не удалось обнаружить. Поэтому если на участке <span class="math">\(k\)</span> не было
ни одного обнаружения, то вероятность получить такую историю наблюдений равняется:</p>
<div class="math">$$
\psi_k \prod_{t=1}^5 (1 - p_{kt}) + (1-\psi_k).
$$</div>
<p>Подобным же образом строятся вероятности получить наблюдаемые истории присутствия следов в общем случае. Однако, полученная модель
будет иметь слишком много параметров, чтобы ее можно было оценить по имеющимся наблюдениям, поэтому модель необходимо упростить.
Наиболее простой вариант -- предположить, что вероятность присутствия вида и обнаружения следов являются константами. В этом
случае  можно построить функцию правдоподобия по результатам всех наблюдений на всех участках:</p>
<div class="math">$$
L(\psi, \mathbf{p}) = \big[\psi^{n_{o}}\prod_{t=1}^T p^{n_t}_t (1-p_t)^{n_{o} - n_t} \big] \times \big[\psi \prod_{t=1}^T (1-p_t)+ (1-\psi) \big].
$$</div>
<p>Таким образом задача сводится к тому, чтобы подобрать такие параметры <span class="math">\(\psi\)</span>, <span class="math">\(p_1, p_2, \dots, p_n\)</span>, которые обеспечивают достижения
максимума функции <span class="math">\(L\)</span>.</p>
<h3>Развитие модели</h3>
<h4>Факторы</h4>
<p>Логично предположить, что вероятность присутсвия вида на некотором участке зависит от неких геоэкологических факторов. Аналогично,
вероятность обнаружения также может меняться в зависимости от определенных параметров, например, погодных. Такие факторы
могут быть встроены в модель, например, можно ее расширить при помощи логистической функции -- потребовать, чтобы величина <span class="math">\(\psi\)</span>
удовлетворяла следующей зависимости от объясняющих факторов <span class="math">\(\mathbf{X}\)</span> и параметров модели <span class="math">\(\mathbf{B}\)</span>:</p>
<div class="math">$$
\psi_i = \frac{e^\mathbf{XB}}{1 + e^\mathbf{XB}}.
$$</div>
<p>
Аналогично моделируется величина <span class="math">\(p\)</span>.</p>
<h4>Отсутсвующие наблюдения</h4>
<p>Не всегда возможно получить одинаковое количество наблюдений за участками. Например, для какого-либо учатка возможна такая история наблюдений:
10-11, когда было пропущено третье по счету исследование. В этом случае функция правдоподобия для данного участка будет выглядеть
следующим образом:</p>
<div class="math">$$
\psi p_1 (1-p_2) p_4 p_5.
$$</div>
<p>В таком случае, чтобы учесть отсутствующие наблюдения, придется вычислять параметры для каждого участка по отдельности,
а не в общем виде.</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>